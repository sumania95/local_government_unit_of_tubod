Imports System
Imports System.Collections.Generic
Imports System.ComponentModel
Imports System.Data
Imports System.Drawing
Imports System.Linq
Imports System.Text
Imports System.Threading.Tasks
Imports System.Windows.Forms
Imports System.Drawing.Printing
Imports Microsoft.VisualBasic

Namespace Reciept_Print_Test
    Public Partial Class Form1
        Inherits Form

        Public Sub New()
            InitializeComponent()
        End Sub

        Private Sub btnAddItem_Click(ByVal sender As Object, ByVal e As EventArgs)
            listBox1.Items.Add(txtName.Text.PadRight(30) + txtPrice.Text)
            txtName.Text = ""
            txtPrice.Text = ""
        End Sub

        Private Sub btnRemoveItem_Click(ByVal sender As Object, ByVal e As EventArgs)
            Try
                listBox1.Items.RemoveAt(listBox1.SelectedIndex)
            Catch __unusedException1__ As Exception
                Return
            End Try
        End Sub

        Private Sub btnPrintReciept_Click(ByVal sender As Object, ByVal e As EventArgs)
            Dim printDialog As PrintDialog = New PrintDialog()
            Dim printDocument As PrintDocument = New PrintDocument()
            printDialog.Document = printDocument
            printDocument.PrintPage += New System.Drawing.Printing.PrintPageEventHandler(AddressOf CreateReceipt)
            Dim result As DialogResult = printDialog.ShowDialog()

            If result = DialogResult.OK Then
                printDocument.Print()
            End If
        End Sub

        Public Sub CreateReceipt(ByVal sender As Object, ByVal e As System.Drawing.Printing.PrintPageEventArgs)
            Dim total As Integer = 0
            Dim cash As Single = Single.Parse(txtCash.Text.Substring(1, 5))
            Dim change As Single = 0.00F
            Dim graphic As Graphics = e.Graphics
            Dim font As Font = New Font("Courier New", 12)
            Dim fontHeight As Single = font.GetHeight()
            Dim startX As Integer = 10
            Dim startY As Integer = 10
            Dim offset As Integer = 40
            graphic.DrawString(" Wangoland Coffee Shop", New Font("Courier New", 18), New SolidBrush(Color.Black), startX, startY)
            Dim top As String = "Item Name".PadRight(30) & "Price"
            graphic.DrawString(top, font, New SolidBrush(Color.Black), startX, startY + offset)
            offset = offset + CInt(fontHeight)
            graphic.DrawString("----------------------------------", font, New SolidBrush(Color.Black), startX, startY + offset)
            offset = offset + CInt(fontHeight) + 5
            Dim totalprice As Single = 0.00F

            For Each item As String In listBox1.Items
                Dim productDescription As String = item
                Dim productTotal As String = item.Substring(item.Length - 6, 6)
                Dim productPrice As Single = Single.Parse(item.Substring(item.Length - 5, 5))
                totalprice += productPrice

                If productDescription.Contains("  -") Then
                    Dim productLine As String = productDescription.Substring(0, 24)
                    graphic.DrawString(productLine, New Font("Courier New", 12, FontStyle.Italic), New SolidBrush(Color.Red), startX, startY + offset)
                    offset = offset + CInt(fontHeight) + 5
                Else
                    Dim productLine As String = productDescription
                    graphic.DrawString(productLine, font, New SolidBrush(Color.Black), startX, startY + offset)
                    offset = offset + CInt(fontHeight) + 5
                End If
            Next

            change = (cash - totalprice)
            offset = offset + 20
            graphic.DrawString("Total to pay ".PadRight(30) & String.Format("{0:c}", totalprice), New Font("Courier New", 12, FontStyle.Bold), New SolidBrush(Color.Black), startX, startY + offset)
            offset = offset + 30
            graphic.DrawString("CASH ".PadRight(30) & String.Format("{0:c}", cash), font, New SolidBrush(Color.Black), startX, startY + offset)
            offset = offset + 15
            graphic.DrawString("CHANGE ".PadRight(30) & String.Format("{0:c}", change), font, New SolidBrush(Color.Black), startX, startY + offset)
            offset = offset + 30
            graphic.DrawString("     Thank-you for your custom,", font, New SolidBrush(Color.Black), startX, startY + offset)
            offset = offset + 15
            graphic.DrawString("       please come back soon!", font, New SolidBrush(Color.Black), startX, startY + offset)
        End Sub

        Private Sub label2_Click(ByVal sender As Object, ByVal e As EventArgs)
        End Sub
    End Class
End Namespace
